{% extends "base.html" %}

{% block title %}{{ t.alerts }} - {{ t.site_name }}{% endblock %}

{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">{{ t.alerts_notifications }}</h1>
    <div class="btn-toolbar mb-2 mb-md-0">
        <div class="btn-group me-2">
            <button type="button" class="btn btn-sm btn-outline-secondary" id="refreshAlerts">
                <i class="fas fa-sync-alt"></i> {{ t.refresh }}
            </button>
        </div>
        <button type="button" class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#newAlertModal">
            <i class="fas fa-plus"></i> {{ t.new_alert }}
        </button>
    </div>
</div>

<!-- Alert Summary -->
<div class="row mb-4">
    <div class="col-md-3">
        <div class="card text-white bg-danger">
            <div class="card-body">
                <h5 class="card-title"><i class="fas fa-exclamation-circle"></i> {{ t.critical }}</h5>
                <h2 class="card-text" id="criticalCount">0</h2>
                <small>{{ t.requires_immediate_attention }}</small>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-warning">
            <div class="card-body">
                <h5 class="card-title"><i class="fas fa-exclamation-triangle"></i> {{ t.warning }}</h5>
                <h2 class="card-text" id="warningCount">0</h2>
                <small>{{ t.performance_degradation }}</small>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-info">
            <div class="card-body">
                <h5 class="card-title"><i class="fas fa-info-circle"></i> {{ t.info }}</h5>
                <h2 class="card-text" id="infoCount">0</h2>
                <small>{{ t.informational_alerts }}</small>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-secondary">
            <div class="card-body">
                <h5 class="card-title"><i class="fas fa-bell-slash"></i> {{ t.resolved }}</h5>
                <h2 class="card-text" id="resolvedCount">0</h2>
                <small>{{ t.recently_resolved }}</small>
            </div>
        </div>
    </div>
</div>

<!-- Active Alerts -->
<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title">{{ t.active_alerts }}</h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead>
                            <tr>
                                <th>{{ t.severity }}</th>
                                <th>{{ t.alert }}</th>
                                <th>{{ t.description }}</th>
                                <th>{{ t.triggered }}</th>
                                <th>{{ t.duration }}</th>
                                <th>{{ t.actions }}</th>
                            </tr>
                        </thead>
                        <tbody id="activeAlerts">
                            <tr>
                                <td><span class="badge bg-warning">{{ t.warning }}</span></td>
                                <td>High Ping Latency</td>
                                <td>Ping latency exceeded threshold (100ms)</td>
                                <td>2025-11-09 14:32:15</td>
                                <td>2 hours ago</td>
                                <td>
                                    <button class="btn btn-sm btn-outline-primary">Acknowledge</button>
                                    <button class="btn btn-sm btn-outline-secondary">Details</button>
                                </td>
                            </tr>
                            <tr>
                                <td><span class="badge bg-danger">{{ t.critical }}</span></td>
                                <td>Low Download Speed</td>
                                <td>Download speed dropped below 50 Mbps</td>
                                <td>2025-11-09 10:15:30</td>
                                <td>6 hours ago</td>
                                <td>
                                    <button class="btn btn-sm btn-outline-primary">Acknowledge</button>
                                    <button class="btn btn-sm btn-outline-secondary">Details</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Alert History -->
<div class="row mt-4">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title">{{ t.alert_history }}</h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>{{ t.severity }}</th>
                                <th>{{ t.alert }}</th>
                                <th>{{ t.description }}</th>
                                <th>{{ t.triggered }}</th>
                                <th>{{ t.resolved }}</th>
                                <th>{{ t.duration }}</th>
                            </tr>
                        </thead>
                        <tbody id="alertHistory">
                            <tr>
                                <td><span class="badge bg-success">{{ t.resolved }}</span></td>
                                <td>Packet Loss Detected</td>
                                <td>5% packet loss detected on connection</td>
                                <td>2025-11-08 16:45:22</td>
                                <td>2025-11-08 17:30:15</td>
                                <td>45 minutes</td>
                            </tr>
                            <tr>
                                <td><span class="badge bg-success">Resolved</span></td>
                                <td>Service Interruption</td>
                                <td>Complete service interruption for 15 minutes</td>
                                <td>2025-11-07 22:10:05</td>
                                <td>2025-11-07 22:25:30</td>
                                <td>15 minutes</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- New Alert Modal -->
<div class="modal fade" id="newAlertModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">{{ t.create_new_alert }}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label for="alertName" class="form-label">{{ t.alert_name }}</label>
                        <input type="text" class="form-control" id="alertName" placeholder="Enter alert name">
                    </div>
                    <div class="mb-3">
                        <label for="alertMetric" class="form-label">{{ t.metric }}</label>
                        <select class="form-select" id="alertMetric">
                            <option value="download">{{ t.download_speed }}</option>
                            <option value="upload">{{ t.upload_speed }}</option>
                            <option value="ping">{{ t.ping }}</option>
                            <option value="packet_loss">{{ t.packet_loss }}</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="alertCondition" class="form-label">{{ t.condition }}</label>
                        <select class="form-select" id="alertCondition">
                            <option value="above">{{ t.condition_above }}</option>
                            <option value="below">{{ t.condition_below }}</option>
                            <option value="equals">{{ t.condition_equals }}</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="alertThreshold" class="form-label">{{ t.threshold_value }}</label>
                        <input type="number" class="form-control" id="alertThreshold" placeholder="Enter threshold value">
                    </div>
                    <div class="mb-3">
                        <label for="alertSeverity" class="form-label">{{ t.severity }}</label>
                        <select class="form-select" id="alertSeverity">
                            <option value="info">{{ t.info }}</option>
                            <option value="warning">{{ t.warning }}</option>
                            <option value="critical">{{ t.critical }}</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="alertNotification" class="form-label">{{ t.notification_method }}</label>
                        <select class="form-select" id="alertNotification">
                            <option value="telegram">Telegram</option>
                            <option value="email">Email</option>
                            <option value="both">{{ t.both }}</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">{{ t.cancel }}</button>
                <button type="button" class="btn btn-primary" id="saveAlert">{{ t.save_alert }}</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Set up refresh button
        document.getElementById('refreshAlerts').addEventListener('click', function() {
            refreshAlerts();
        });
        
        // Set up save alert button
        document.getElementById('saveAlert').addEventListener('click', function() {
            saveAlert();
        });
    });
    
    function refreshAlerts() {
        // Refresh alerts from server
        // Implementation would go here
    }
    
    function saveAlert() {
        // Save new alert configuration
        // Implementation would go here
        document.querySelector('[data-bs-dismiss="modal"]').click();
    }
</script>
{% endblock %}