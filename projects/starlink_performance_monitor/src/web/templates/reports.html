{% extends "base.html" %}

{% block title %}{{ t.reports }} - {{ t.site_name }}{% endblock %}

{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">{{ t.reports }}</h1>
    <div class="btn-toolbar mb-2 mb-md-0">
        <div class="btn-group me-2">
            <button type="button" class="btn btn-sm btn-outline-secondary" id="generateReport">
                <i class="fas fa-file-medical"></i> {{ t.generate_report }}
            </button>
        </div>
        <button type="button" class="btn btn-sm btn-outline-primary dropdown-toggle" data-bs-toggle="dropdown">
            <i class="fas fa-download"></i> {{ t.export_format }}
        </button>
        <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="#" data-format="pdf">PDF</a></li>
            <li><a class="dropdown-item" href="#" data-format="excel">Excel</a></li>
            <li><a class="dropdown-item" href="#" data-format="csv">CSV</a></li>
        </ul>
    </div>
</div>

<!-- Report Generation -->
<div class="row mb-4">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title">{{ t.generate_new_report }}</h5>
            </div>
            <div class="card-body">
                <form>
                    <div class="row">
                        <div class="col-md-4">
                            <label for="reportType" class="form-label">{{ t.report_type }}</label>
                            <select class="form-select" id="reportType">
                                <option value="daily">{{ t.daily_report }}</option>
                                <option value="weekly">{{ t.weekly_report }}</option>
                                <option value="monthly">{{ t.monthly_report }}</option>
                                <option value="custom">{{ t.custom_report }}</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label for="reportStartDate" class="form-label">{{ t.start_date }}</label>
                            <input type="date" class="form-control" id="reportStartDate">
                        </div>
                        <div class="col-md-4">
                            <label for="reportEndDate" class="form-label">{{ t.end_date }}</label>
                            <input type="date" class="form-control" id="reportEndDate">
                        </div>
                    </div>
                    <div class="row mt-3">
                        <div class="col-md-6">
                            <label for="reportMetrics" class="form-label">{{ t.metrics_to_include }}</label>
                            <div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="includeSpeed" checked>
                                    <label class="form-check-label" for="includeSpeed">
                                        {{ t.speed_test_results }}
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="includePing" checked>
                                    <label class="form-check-label" for="includePing">
                                        {{ t.ping_statistics }}
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="includeWeather" checked>
                                    <label class="form-check-label" for="includeWeather">
                                        {{ t.weather_correlation }}
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="includeAlerts" checked>
                                    <label class="form-check-label" for="includeAlerts">
                                        {{ t.alert_history }}
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label for="reportFormat" class="form-label">{{ t.output_format }}</label>
                            <select class="form-select" id="reportFormat">
                                <option value="pdf">PDF Document</option>
                                <option value="excel">Excel Spreadsheet</option>
                                <option value="csv">CSV Data</option>
                                <option value="html">HTML Report</option>
                            </select>
                            <div class="mt-3">
                                <button type="button" class="btn btn-primary" id="generateBtn">
                                    <i class="fas fa-cogs"></i> {{ t.generate_report }}
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Recent Reports -->
<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title">{{ t.recent_reports }}</h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>{{ t.report_name }}</th>
                                <th>{{ t.type }}</th>
                                <th>{{ t.date_range }}</th>
                                <th>{{ t.generated }}</th>
                                <th>{{ t.size }}</th>
                                <th>{{ t.actions }}</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Weekly Performance Report - 2025-W45</td>
                                <td>Weekly</td>
                                <td>Nov 3 - Nov 9, 2025</td>
                                <td>Nov 9, 2025 08:00</td>
                                <td>2.4 MB</td>
                                <td>
                                    <button class="btn btn-sm btn-outline-primary">{{ t.view }}</button>
                                    <button class="btn btn-sm btn-outline-secondary">{{ t.download }}</button>
                                </td>
                            </tr>
                            <tr>
                                <td>Daily Report - 2025-11-08</td>
                                <td>Daily</td>
                                <td>Nov 8, 2025</td>
                                <td>Nov 8, 2025 08:00</td>
                                <td>1.1 MB</td>
                                <td>
                                    <button class="btn btn-sm btn-outline-primary">{{ t.view }}</button>
                                    <button class="btn btn-sm btn-outline-secondary">{{ t.download }}</button>
                                </td>
                            </tr>
                            <tr>
                                <td>Monthly Performance Report - October 2025</td>
                                <td>Monthly</td>
                                <td>Oct 1 - Oct 31, 2025</td>
                                <td>Nov 1, 2025 08:00</td>
                                <td>5.7 MB</td>
                                <td>
                                    <button class="btn btn-sm btn-outline-primary">{{ t.view }}</button>
                                    <button class="btn btn-sm btn-outline-secondary">{{ t.download }}</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Report Preview -->
<div class="row mt-4">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title">{{ t.report_preview }}</h5>
            </div>
            <div class="card-body">
                <div class="text-center">
                    <i class="fas fa-file-alt fa-5x text-muted mb-3"></i>
                    <p>{{ t.select_report_to_preview }}</p>
                    <button class="btn btn-outline-primary">{{ t.view_sample_report }}</button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Set up generate report button
        document.getElementById('generateBtn').addEventListener('click', function() {
            generateReport();
        });
        
        // Update date fields based on report type
        document.getElementById('reportType').addEventListener('change', function() {
            updateDateFields(this.value);
        });
        
        // Initialize date fields
        updateDateFields('daily');
    });
    
    function updateDateFields(reportType) {
        const today = new Date();
        const startDateInput = document.getElementById('reportStartDate');
        const endDateInput = document.getElementById('reportEndDate');
        
        let startDate, endDate;
        
        switch(reportType) {
            case 'daily':
                startDate = new Date(today);
                startDate.setDate(today.getDate() - 1);
                endDate = new Date(today);
                endDate.setDate(today.getDate() - 1);
                break;
            case 'weekly':
                startDate = new Date(today);
                startDate.setDate(today.getDate() - 7);
                endDate = new Date(today);
                break;
            case 'monthly':
                startDate = new Date(today);
                startDate.setMonth(today.getMonth() - 1);
                endDate = new Date(today);
                break;
            case 'custom':
                startDateInput.disabled = false;
                endDateInput.disabled = false;
                return;
        }
        
        startDateInput.disabled = reportType !== 'custom';
        endDateInput.disabled = reportType !== 'custom';
        
        startDateInput.value = startDate.toISOString().split('T')[0];
        endDateInput.value = endDate.toISOString().split('T')[0];
    }
    
    function generateReport() {
        // Generate report based on form inputs
        // Implementation would go here
        alert('Report generation started. This may take a few moments.');
    }
</script>
{% endblock %}